/* jHash v2.1 http://jhash.codeplex.com  Modified By Anubhav Jain -- Added crawlable feature and hashChar default is #! */
(function(i){var p=i.document.documentMode;var m=("onhashchange" in i)&&(p===undefined||p>7);var h=i.jHash={jhash:"2.1",crawlable:true,hashChar:"#!",change:function(q){if(m){d(i,"hashchange",q)}else{a.push(q)}},unbind:function(s){var r=0,q=0;if(m){g(i,"hashchange",s)}else{k(a,a.indexOf(s))}return this},val:function(q,r){var s=h.query();if(arguments.length===2){s[q.toLowerCase()]=(r===null?"":r);return this.set(this.root(),s)}else{if(arguments.length===1&&typeof(q)==="string"){return s[q.toLowerCase()]}else{if(typeof(q)==="object"){return this.set(this.root(),q)}}}return s},root:function(q){if(q===undefined){return f(i.location.hash)}return this.set(q,this.val())},set:function(q,u){var t=null;if(q===null&&u===null){t=null}else{if(u!==undefined){var s=q;var r=typeof(u)==="string"?u:o(u);if(r.length>0){s+="?"}t=s+r}else{t=q}}if(this.crawlable&&this.hashChar.length>1){t=this.hashChar.substring(1,this.hashChar.length)+t}i.location.hash=t;return this},remove:function(q){var r=h.query();r[q.toLowerCase()]=undefined;return this.set(this.root(),r)},query:function(){return j(i.location.hash)},clear:function(){i.location.hash="";return this},clearQuery:function(){this.set(this.root());return this},clearRoot:function(){this.set("",this.query());return this},_routes:{},_routeHandlerRegistered:false,_defaultRoute:null,route:function(q,r){this._routes[q]=r;if(!this._routeHandlerRegistered){this._routeHandlerRegistered=true;h.change(c)}},processRoute:function(){c()},defaultRoute:function(q,r){if(arguments.length==0){return this._defaultRoute}this._defaultRoute={root:q,query:r}}};if(!m){i.setInterval(function(){var r=i.location.hash;if(e!==r){for(var q in a){a[q].call(i)}}e=r},200)}var a=[],e=i.location.hash,d=function(q,s,r){if(q.addEventListener){q.addEventListener(s,r,false)}else{if(q.attachEvent){q.attachEvent("on"+s,r)}else{q["on"+s]+=r}}},g=function(q,s,r){if(q.removeEventListener){q.removeEventListener(s,r,false)}else{if(q.detachEvent){q.detachEvent("on"+s,r)}else{q["on"+s]-=r}}},k=function(t,s,r){var q=t.slice((r||s)+1||t.length);t.length=s<0?t.length+s:s;return t.push.apply(t,q)},j=function(v){var w={},s=null,y=v.substring(0,v.length);if(v!==null&&v!==undefined){var x="#";if(h.crawlable){x=h.hashChar}var r=y.indexOf(x);if(r>-1){y=y.substring(r+x.length,y.length)}var q=y.indexOf("?");if(q>-1){y=y.substring(q+1,y.length);var t=y.split("&");for(var u in t){s=t[u].split("=");w[s[0].toString().toLowerCase()]=s[1]}}}return w},o=function(q){var t="";for(var r in q){if(q[r]!==undefined){if(t.length>0){t+="&"}t+=r.toString()+"="+q[r].toString()}}return t},f=function(s){var t=s.substring(0,s.length);var q="#";if(h.crawlable){q=h.hashChar}var r=t.indexOf(q);if(r>-1){t=t.substring(r+q.length,t.length)}if(t.indexOf("?")>-1){t=t.substring(0,t.indexOf("?"))}return t},n="([^/]+)",b=/{([\w\d]+)}/g,l=function(r,q){var s=new RegExp(r.replace(b,n)+"$");return q.match(s)},c=function(){var x=h.root();var w=h.defaultRoute();if((x||"").length===0&&w){h.set(w.root,w.query);return}for(var q in h._routes){if(typeof(q)==="string"){var u=l(q,x);if(u!==null){var z=h._routes[q];var t={};var y=q.match(b);if(y!==null){for(var v=0;v<y.length;v++){var s=y[v].substring(1).substring(0,y[v].length-2);t[s]=u[v+1]}}z.call(t);return}}}}})(window);